Функция, где устанавливается цвет для события (Cal_n_Bg):

Файл: OmniCal_Events_Renderer.lua
Функция: PlaceEventsForDay(dayOffset, groupPrefix, colIndex)

WEB ➜  
**WebParser меры** `Gcalendar.ini` ➜  
**Input(a)** `Reader.lua` ➜  
**Output()** `Reader.lua` ➜  
**parseVarsFallback()** `OmniCal_Events.lua` ➜  
**collectEvents()** `OmniCal_Events.lua` ➜  
**classify_events_for_day()** `OmniCal_Events.lua` ➜  
**Process()** `OmniCal_Events.lua` ➜  
**PlaceEventsForDay(dayOffset, groupPrefix, colIndex)** `OmniCal_Events_Renderer.lua`

**Подробное описание потока:**

1. **WebParser меры** в `Gcalendar.ini`:
   
   - Получают данные из Google Calendar API
   - Хранят сырые данные в строковом формате

2. **Input(a)** в `Reader.lua`:
   
   - Обрабатывает сырые данные из WebParser
   - Парсит iCalendar формат
   - Создает объекты событий с SourceFeed

3. **Output()** в `Reader.lua`:
   
   - Преобразует события в переменные Rainmeter
   - Создает `Item1Title`, `Item1SourceFeed`, `Item1Date` и т.д.
   - Записывает через `!SetVariable`

4. **parseVarsFallback()** в `OmniCal_Events.lua`:
   
   - Читает переменные Rainmeter (`SKIN:GetVariable('Item' .. i .. 'SourceFeed')`, `SKIN:GetVariable('Item' .. i .. 'Desc')` и др.)
   - Создает объекты событий с полями Title, Date, DateEnd, Raw, SourceFeed, Desc

5. **collectEvents()** в `OmniCal_Events.lua`:
   
   - Пытается собрать события из Feeds[1], если они доступны
   - В противном случае вызывает parseVarsFallback() для получения данных
   - Сортирует события по времени начала

6. **classify_events_for_day()** в `OmniCal_Events.lua`:
   
   - Отбирает и классифицирует события по дням (сегодня, завтра, послезавтра)
   - Группирует события по типам: Completed hidden, Completed visible, Current, Future visible, Future hidden

7. **Process()** в `OmniCal_Events.lua`:
   
   - Инициирует обработку для всех `DisplayedDays` дней 
   - Заполняет глобальную таблицу CalendarEvents событиями

8. **PlaceEventsForDay(dayOffset, groupPrefix, colIndex)** в `OmniCal_Events_Renderer.lua`:
   
   - Получает события из глобальной таблицы CalendarEvents
   - Для каждого события берет `ev.SourceFeed`
   - Устанавливает цвет: `SKIN:GetVariable('Cal_' .. sourceFeed .. '_Bg')`
